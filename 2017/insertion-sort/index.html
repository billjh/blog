<!DOCTYPE html>
<html lang="zh-Hans">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="A stable and adaptive quadratic sorting algorithm. [Best: O(n), Average: O(n2), Worst: O(n2), Space: O(1)]">
    

    <!--Author-->
    
        <meta name="author" content="Jiang Huan">
    

    <!-- Title -->
    
    <title>Insertion Sort | Jiang Huan</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/blog/css/style.css">

    <!-- Custom Fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Special+Elite|Permanent+Marker" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>


<body>

    <!-- Content -->
    <section class="article-container">
<!-- Back Home -->
<a class="nav-back" href="/blog/">
    <i class="fa fa-align-right"></i>
</a>


<!-- Page Header -->
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Insertion Sort</h1>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Main Content -->
            <div class="post-content col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>A stable and adaptive quadratic sorting algorithm. [Best: O(n), Average: O(n<sup>2</sup>), Worst: O(n<sup>2</sup>), Space: O(1)]</p>
<a id="more"></a>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/0/0f/Insertion-sort-example-300px.gif" alt></p>
<h3 id="Idea"><a href="#Idea" class="headerlink" title="Idea"></a>Idea</h3><p>The idea of insertion sort is to start with <em>a sorted array</em> of the first item on the left, and move one unsorted item to correct position by comparing with the sorted items, and repeat until all items are sorted.</p>
<p>There are two noteworthy advantages of insertion sort. First, insertion sort is <em>stable</em> in nature. The relative order of items with equal <em>key</em> remains unchanged before and after sorting. Second, insertion sort is very efficient on almost already sorted arrays.</p>
<h3 id="First-Implementation-in-Go"><a href="#First-Implementation-in-Go" class="headerlink" title="First Implementation in Go"></a>First Implementation in Go</h3><p>Below is my first implementation. It’s concise since I can perform the swaps without temporary variable, thanks to golang’s parallel assignment.</p>
<figure class="highlight go"><figcaption><span>insertion_sort.go</span><a href="https://github.com/billjh/algo/blob/master/sorting/insertion_sort.go" target="_blank" rel="noopener">source</a></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> sorting</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">InsertionSort</span><span class="params">(arr []<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt; <span class="built_in">len</span>(arr); i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := i; j &gt; <span class="number">0</span> &amp;&amp; arr[j] &lt; arr[j<span class="number">-1</span>]; j-- &#123;</span><br><span class="line">			arr[j], arr[j<span class="number">-1</span>] = arr[j<span class="number">-1</span>], arr[j]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Optimization"><a href="#Optimization" class="headerlink" title="Optimization"></a>Optimization</h3><p>The above implementation leaves rooms for performance tuning. In the outer loop, to move an item with <em>k</em> swaps takes <em>2k</em> operations. It can be cut down to half by shifting each item to its neighbor with only <em>k</em> operations.</p>
<figure class="highlight go"><figcaption><span>insertion_sort_optimized.go</span><a href="https://github.com/billjh/algo/blob/master/sorting/insertion_sort_optimized.go" target="_blank" rel="noopener">source</a></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> sorting</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">OptimizedInsertionSort</span><span class="params">(arr []<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt; <span class="built_in">len</span>(arr); i++ &#123;</span><br><span class="line marked">		unsorted := arr[i]</span><br><span class="line marked">		j := i - <span class="number">1</span></span><br><span class="line marked">		<span class="keyword">for</span> ; j &gt;= <span class="number">0</span> &amp;&amp; unsorted &lt; arr[j]; j-- &#123;</span><br><span class="line marked">			arr[j+<span class="number">1</span>] = arr[j]</span><br><span class="line marked">		&#125;</span><br><span class="line marked">		arr[j+<span class="number">1</span>] = unsorted</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>With the help of go benchmark tool, we see a constant performance growth of around 2x after optimization.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">► go test -bench=.</span><br><span class="line marked">BenchmarkOptimizedInsertionSort100-8            10000000               120 ns/op</span><br><span class="line marked">BenchmarkOptimizedInsertionSort1000-8            1000000              1075 ns/op</span><br><span class="line marked">BenchmarkOptimizedInsertionSort10000-8            100000             10584 ns/op</span><br><span class="line">BenchmarkInsertionSort100-8                     10000000               204 ns/op</span><br><span class="line">BenchmarkInsertionSort1000-8                     1000000              1916 ns/op</span><br><span class="line">BenchmarkInsertionSort10000-8                     100000             19044 ns/op</span><br><span class="line">PASS</span><br><span class="line">ok      github.com/billjh/algo/sorting  10.389s</span><br></pre></td></tr></table></figure>


<p><em>References:</em></p>
<ol>
<li><a href="https://en.wikipedia.org/wiki/Insertion_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Insertion_sort</a></li>
<li><a href="https://github.com/billjh/algo/tree/master/sorting" target="_blank" rel="noopener">https://github.com/billjh/algo/tree/master/sorting</a></li>
<li><a href="https://betterexplained.com/articles/sorting-algorithms/#Insertion_Sort_Best_ON_WorstON2" target="_blank" rel="noopener">https://betterexplained.com/articles/sorting-algorithms/#Insertion_Sort_Best_ON_WorstON2</a></li>
<li><a href="https://golang.org/pkg/testing/#hdr-Benchmarks" target="_blank" rel="noopener">https://golang.org/pkg/testing/#hdr-Benchmarks</a></li>
</ol>


                <!-- Meta -->
                <div class="post-meta">
                    <hr>
                    <br>
                    <div class="post-tags">
                        
                            

<a href="/blog/tags/algorithms/">#algorithms</a> <a href="/blog/tags/sorting/">#sorting</a> <a href="/blog/tags/golang/">#golang</a>


                        
                    </div>
                    <div class="post-date">
                        Thursday, Feb 16 2017
                    </div>
                </div>
            </div>

            <!-- Comments -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- Disqus Comments -->

<div id="disqus_thread" class="comment"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES * * */
  var disqus_shortname = 'billjiang';

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


            </div>
        </div>
    </div>
</article>
</section>


    <!-- Scripts -->
    <!-- jQuery -->
<script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="//cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-92157640-1', 'auto');
        ga('send', 'pageview');

    </script>


</body>

</html>